
> customer@0.1.0 test
> jest src/components/dashboard/DashboardLayout.test.tsx

(node:21632) [DEP0040] DeprecationWarning: The `punycode` module is deprecated. Please use a userland alternative instead.
(Use `node --trace-deprecation ...` to show where the warning was created)
FAIL src/components/dashboard/DashboardLayout.test.tsx
  DashboardLayout - Authentication Guard
    ÔêÜ should redirect to login when user is not authenticated (22 ms)
    ÔêÜ should show loading state while checking authentication (11 ms)
    ├ù should render dashboard when user is authenticated (25 ms)
    ÔêÜ should redirect with correct locale in URL (11 ms)
    ├ù should not allow access after logout (user becomes null) (4 ms)

  ÔùÅ DashboardLayout - Authentication Guard ÔÇ║ should render dashboard when user is authenticated

    usePreferences must be used within a PreferencesProvider

      131 |     const context = useContext(PreferencesContext);
      132 |     if (context === undefined) {
    > 133 |         throw new Error('usePreferences must be used within a PreferencesProvider');
          |               ^
      134 |     }
      135 |     return context;
      136 | }

      at usePreferences (src/context/PreferencesContext.tsx:133:15)
      at Sidebar (src/components/dashboard/Sidebar.tsx:28:49)
      at Object.react_stack_bottom_frame (node_modules/react-dom/cjs/react-dom-client.development.js:25904:20)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom-client.development.js:7662:22)
      at updateFunctionComponent (node_modules/react-dom/cjs/react-dom-client.development.js:10166:19)
      at beginWork (node_modules/react-dom/cjs/react-dom-client.development.js:11778:18)
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom-client.development.js:17641:22)
      at workLoopSync (node_modules/react-dom/cjs/react-dom-client.development.js:17469:41)
      at renderRootSync (node_modules/react-dom/cjs/react-dom-client.development.js:17450:11)
      at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:16583:35)
      at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:18957:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:590:34)
      at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:884:10)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:189:26)
      at render (node_modules/@testing-library/react/dist/pure.js:291:10)
      at Object.<anonymous> (src/components/dashboard/DashboardLayout.test.tsx:88:15)

  ÔùÅ DashboardLayout - Authentication Guard ÔÇ║ should not allow access after logout (user becomes null)

    usePreferences must be used within a PreferencesProvider

      131 |     const context = useContext(PreferencesContext);
      132 |     if (context === undefined) {
    > 133 |         throw new Error('usePreferences must be used within a PreferencesProvider');
          |               ^
      134 |     }
      135 |     return context;
      136 | }

      at usePreferences (src/context/PreferencesContext.tsx:133:15)
      at Sidebar (src/components/dashboard/Sidebar.tsx:28:49)
      at Object.react_stack_bottom_frame (node_modules/react-dom/cjs/react-dom-client.development.js:25904:20)
      at renderWithHooks (node_modules/react-dom/cjs/react-dom-client.development.js:7662:22)
      at updateFunctionComponent (node_modules/react-dom/cjs/react-dom-client.development.js:10166:19)
      at beginWork (node_modules/react-dom/cjs/react-dom-client.development.js:11778:18)
      at runWithFiberInDEV (node_modules/react-dom/cjs/react-dom-client.development.js:874:13)
      at performUnitOfWork (node_modules/react-dom/cjs/react-dom-client.development.js:17641:22)
      at workLoopSync (node_modules/react-dom/cjs/react-dom-client.development.js:17469:41)
      at renderRootSync (node_modules/react-dom/cjs/react-dom-client.development.js:17450:11)
      at performWorkOnRoot (node_modules/react-dom/cjs/react-dom-client.development.js:16583:35)
      at performWorkOnRootViaSchedulerTask (node_modules/react-dom/cjs/react-dom-client.development.js:18957:7)
      at flushActQueue (node_modules/react/cjs/react.development.js:590:34)
      at Object.<anonymous>.process.env.NODE_ENV.exports.act (node_modules/react/cjs/react.development.js:884:10)
      at node_modules/@testing-library/react/dist/act-compat.js:46:25
      at renderRoot (node_modules/@testing-library/react/dist/pure.js:189:26)
      at rerender (node_modules/@testing-library/react/dist/pure.js:210:7)
      at Object.rerender (src/components/dashboard/DashboardLayout.test.tsx:136:9)

Test Suites: 1 failed, 1 total
Tests:       2 failed, 3 passed, 5 total
Snapshots:   0 total
Time:        1.128 s
Ran all test suites matching /src\\components\\dashboard\\DashboardLayout.test.tsx/i.
